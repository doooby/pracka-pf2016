//= require ./bliss
//= require d2o
//= depend_on_asset pf

(function (factory) {

  var root = self;
  var PF = factory(root, {});
  root.PF = PF;

}(function (root, PF) {

  "use strict";
  var load_semaphore;

  <%= environment.find_asset('pf').to_s %>

  document.addEventListener("DOMContentLoaded", function() {
    if (load_semaphore) load_semaphore();
    else load_semaphore = true;
  });

  (new D2O.Loader()).enqueueImages({
    "bg1": "<%= image_path 'pozadi1.png' %>",
    "bg2": "<%= image_path 'pozadi2.png' %>",

    "koci": "<%= image_path 'koci.png' %>",
    "tygr": "<%= image_path 'tygr.png' %>",
    "zela": "<%= image_path 'zela.png' %>",

    "brouk": "<%= image_path 'brouk.png' %>",
    "kluk": "<%= image_path 'kluk.png' %>",
    "oplatka": "<%= image_path 'oplatka.png' %>",
    "chobotnice": "<%= image_path 'chobotnice.png' %>",

    "mazlicek": "<%= image_path 'mazlicek.png' %>",
    "penize": "<%= image_path 'penize.png' %>",
    "srdce": "<%= image_path 'srdce.png' %>",
    "uspech": "<%= image_path 'uspech.png' %>",
    "zdravi": "<%= image_path 'zdravi.png' %>",
    "stesti": "<%= image_path 'stesti.png' %>"
  }).enqueue(function () {
    if (load_semaphore) this.doNext();
    else load_semaphore = this.doNext;
  }).enqueue(function () {
    PF.images = this.images;
    PF.canvas.prepare(90, 3/5);
    PF.canvas._on_resize();

    PF.scenes.createSceneHolder();

    PF.scenes.intro();

  }).start();

  return PF;
}));